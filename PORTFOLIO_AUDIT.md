# Portfolio Technical Audit

| Severity | Category | Issue Description | Suggested Refactor |
| :--- | :--- | :--- | :--- |
| **High** | Architecture | Locale middleware is defined in `/Users/anvar/Developer/Projects/anvsult-portfolio/src/proxy.ts:1` but there is no root `middleware.ts`, so Next.js never applies i18n routing/redirects. | Move this file to a root-level `middleware.ts` or `src/middleware.ts` and export the same config so locale detection actually runs. |
| **High** | Architecture | Admin routes ignore locale. Hardcoded `/admin` links break localized routing in multiple places: `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/layout.tsx:10`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/login/page.tsx:25`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/page.tsx:20`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/ProjectActions.tsx:32`. | Build URLs with the active locale (e.g., `/${locale}/admin/...`) and/or use `next-intl` navigation helpers to keep locale consistent. |
| **High** | Security | Server actions in admin folders perform mutations without auth checks: `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/skills/actions.ts:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/actions.ts:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/experience/actions.ts:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/messages/actions.ts:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/testimonials/actions.ts:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/hobbies/actions.ts:1`. Anyone can call these actions directly. | Guard each action with a server-side auth check (Supabase session + role), or move mutations behind API routes with middleware protection. |
| **High** | Admin AX | Project edit flow is broken. `ProjectActions` navigates to `/admin/projects/[id]/edit` at `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/ProjectActions.tsx:32`, but no edit page exists. | Add an edit route (`src/app/[locale]/admin/projects/[id]/edit/page.tsx`) or remove the edit button until it exists. |
| **High** | Mobile UX | Experience timeline hard-codes 50% widths and a centered line, which collapses on mobile: `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/ExperienceCard.tsx:26` and `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/Timeline.tsx:26`. | Add responsive variants (`w-full` on small screens, stacked cards, hide/relocate the center line) and reduce animation offsets for small viewports. |
| **High** | Mobile UX | Hobbies grid is fixed to `grid-cols-5 grid-rows-2` at `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/page.tsx:151`, which will overflow on phones and creates tiny tap targets. | Switch to responsive grid (`grid-cols-2 sm:grid-cols-3 lg:grid-cols-5`) and increase card padding on small screens. |
| **High** | Performance | `react-pdf` is bundled on initial load for the homepage in `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/ResumePreview.tsx:4`. This is a large dependency and will slow mobile TTI. | Dynamically import the preview (`dynamic(..., { ssr: false })`), lazy load on interaction (e.g., “Preview” button), or replace with a lightweight thumbnail + download. |
| **Med** | Next.js / SSR | `LandingPage` runs 6 sequential Prisma queries (not parallelized) at `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/page.tsx:19`. This increases TTFB and blocks SSR. | Use `Promise.all` or `prisma.$transaction`, and `select` only needed fields to reduce query cost. |
| **Med** | Architecture | Data access is tightly coupled to rendering in `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/page.tsx:1`. This makes testing and caching hard. | Extract data loaders into `/Users/anvar/Developer/Projects/anvsult-portfolio/src/lib/` (e.g., `getLandingData(locale)`) and cache with `unstable_cache` or `revalidateTag`. |
| **Med** | Next.js / Caching | `revalidatePath` uses the literal `"/[locale]"` string in multiple actions (e.g., `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/skills/actions.ts:20`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/actions.ts:36`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/experience/actions.ts:39`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/testimonials/actions.ts:11`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/hobbies/actions.ts:23`). Those paths won’t match real URLs. | Pass the current locale into actions and call `revalidatePath(
`/${locale}/admin/...`)
` or switch to `revalidateTag` with a tag per locale. |
| **Med** | Performance | Multiple components are forced to be client components for animation only: `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/ProjectCard.tsx:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/SkillCard.tsx:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/TestimonialCard.tsx:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/ExperienceCard.tsx:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/HobbyCard.tsx:1`, `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/Timeline.tsx:1`. | Convert static layout to server components and isolate motion to small client wrappers. Consider `LazyMotion` or CSS transitions with `prefers-reduced-motion`. |
| **Med** | Admin AX | Deleting projects doesn’t update the list on the client; `ProjectActions` calls a server action without `router.refresh()` at `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/ProjectActions.tsx:22`. | After delete, call `router.refresh()` (or switch to `<form action={deleteProject}>` so Next revalidates + refreshes). |
| **Med** | Admin AX | Experience entries are add-only (no edit UI): `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/experience/page.tsx:38`. This forces delete/recreate and is slow for admins. | Add edit dialog or inline edit with a prefilled form. |
| **Med** | Mobile UX | Resume preview forces a fixed width `width={400}` at `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/ResumePreview.tsx:49`, causing horizontal overflow on small devices. | Use responsive width (e.g., measure container, `width={Math.min(400, containerWidth)}`) or CSS `max-w-full`. |
| **Low** | Admin AX | “Cancel” on new project does nothing (`/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/new/page.tsx:84`). | Either wire it to `router.back()` or remove the button until it has a defined behavior. |
| **Low** | Architecture | `createProject` slugging is naive and not collision-safe (`/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/admin/projects/actions.ts:28`). | Use a slug library (e.g., `slugify`) and ensure uniqueness, possibly with a suffix on collision. |
| **Low** | Security | Public write endpoints lack spam mitigation (`/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/contact/actions.ts:6` and `/Users/anvar/Developer/Projects/anvsult-portfolio/src/app/[locale]/testimonials/actions.ts:6`). | Add rate limiting, honeypot field, or CAPTCHA verification. |
| **Low** | Mobile UX | Bottom nav lacks safe-area padding and may overlap OS UI on iOS: `/Users/anvar/Developer/Projects/anvsult-portfolio/src/components/portfolio/BottomNav.tsx:31`. | Add `pb-[env(safe-area-inset-bottom)]` and reduce height on small screens. |
